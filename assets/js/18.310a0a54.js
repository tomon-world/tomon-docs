(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{364:function(t,o,e){"use strict";e.r(o);var v=e(42),_=Object(v.a)({},(function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"连接到-tomon"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#连接到-tomon"}},[t._v("#")]),t._v(" 连接到 Tomon")]),t._v(" "),e("h2",{attrs:{id:"实时推送"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实时推送"}},[t._v("#")]),t._v(" 实时推送")]),t._v(" "),e("p",[t._v("当你通过鉴权获取 Tomon 的 Token 后，需要建立 WebSocket 和 Tomon 保持连接，以接收来自 Tomon 服务器的实时推送。")]),t._v(" "),e("p",[t._v("实时推送可以保证你能够即时收到来自群组的消息。")]),t._v(" "),e("p",[t._v("具体可以参考文档"),e("a",{attrs:{href:"../docs/socket"}},[t._v("实时推送")]),t._v("。")]),t._v(" "),e("p",[t._v("这里大致介绍一下连接流程。")]),t._v(" "),e("ol",[e("li",[t._v("通过"),e("a",{attrs:{href:"../docs/auth"}},[t._v("鉴权")]),t._v("获取 Token")]),t._v(" "),e("li",[t._v("建立 WebSocket 连接："),e("code",[t._v("gateway.tomon.co")]),t._v("，具体参看"),e("a",{attrs:{href:"../docs/socket#%E8%BF%9E%E6%8E%A5%E5%9C%B0%E5%9D%80"}},[t._v("实时推送")])]),t._v(" "),e("li",[t._v("建立成功后，收到服务器的"),e("code",[t._v("HELLO")]),t._v("数据，按照心跳包时长启动心跳包计时器，在指定时间内持续发送心跳包，具体参看"),e("a",{attrs:{href:"../docs/socket#hello"}},[t._v("HELLO")])]),t._v(" "),e("li",[t._v("通过 WebSocket 发送 Token 到服务器，具体参看"),e("a",{attrs:{href:"../docs/socket#identity"}},[t._v("IDENTITY")])]),t._v(" "),e("li",[t._v("收到来自服务器的"),e("code",[t._v("IDENTITY")]),t._v("数据")]),t._v(" "),e("li",[t._v("大功告成！ ٩(˃̶͈̀௰˂̶͈́)و 保持连接，你将会持续收到来自服务器的实时推送，具体事件参考"),e("a",{attrs:{href:"../docs/socket#dispatch"}},[t._v("DISPATCH")])]),t._v(" "),e("li",[t._v("ちょっと待ってください！还有一点需要注意一下，WebSocket 因为网络问题可能会断卡，需要 bot 加入重连机制，每次重连暂时还是上面的流程。另外注意维持第 3 点说的心跳包，否则会丢失在线状态")])]),t._v(" "),e("p",[t._v("觉得复杂？不用担心，我们正在准备各个语言支持的 Bot SDK，具体看下一页。")])])}),[],!1,null,null,null);o.default=_.exports}}]);